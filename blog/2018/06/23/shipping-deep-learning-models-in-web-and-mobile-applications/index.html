
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Shipping Deep Learning Models in Web and Mobile Applications - Danial Khosravi's Blog</title>
  <meta name="author" content="Danial Khosravi">

  
  <meta name="description" content="Web Application (running in your browser!) Start document.addEventListener("DOMContentLoaded", function(event) { $('#liveSentimentStart').on("click &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://DanialK.github.com/blog/2018/06/23/shipping-deep-learning-models-in-web-and-mobile-applications/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Danial Khosravi's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<script type="text/javascript">
    window.onload = function () {
        var containerId = "subtitle";
        var subtitle = document.getElementById(containerId);
        var texts = [
            "Artificial Intelligence",
            "Machine Learning",
            "Statistics",
            "Web Development",
            "Functional Programming",
            subtitle.innerHTML, // "Entrepreneur in the making...",
        ];

        function simulateType(textIndex) {
            subtitle.innerHTML = "";
            var text = texts[textIndex];

            var time = 200;
            for (var i = 0; i < text.length; i++) {
                (function (char) {
                    setTimeout(function () {
                        subtitle.innerHTML = subtitle.innerHTML + char;
                    }, time + i * time);
                })(text[i]);
            }

            setTimeout(function () {
                var nextIndex = textIndex + 1;
                simulateBackslash(nextIndex === texts.length ? 0 : nextIndex);
            }, time * text.length + 1500);
        }

        function simulateBackslash(textIndex) {
            var text = subtitle.innerHTML
            var time = 50;

            for (var i = text.length - 1; i >= 0; i--) {
                (function (index) {
                    setTimeout(function () {
                        subtitle.innerHTML = subtitle.innerHTML.substring(0, index);
                    }, time + (text.length - i) * time);
                })(i);
            }

            setTimeout(function () {
                simulateType(textIndex);
            }, 2000);
        }
        simulateBackslash(0);
    }
</script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26114012-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Danial Khosravi's Blog</a></h1>
  
    <h2 id='subtitle' style="height: 27px;"> Entrepreneur in the making... </h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:DanialK.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Shipping Deep Learning Models in Web and Mobile Applications</h1>
    
    
      <p class="meta">
        








  


<time datetime="2018-06-23T23:16:00+10:00" pubdate data-updated="true">Jun 23<span>rd</span>, 2018</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h3>Web Application (running in your browser!)</h3>

<p><link rel="stylesheet" type="text/css" href="/stylesheets/custom/livesentiment/livesentiment_post.css"></p>

<div id="livesentimentIframeHolder">
    <button id="liveSentimentStart">Start</button>
</div>




<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) { 
    $('#liveSentimentStart').on("click", function() {
        if(!$('#livesentimentIframe').length) {
            $('#livesentimentIframeHolder').html('<iframe id="livesentimentIframe" src="/javascripts/custom/livesentiment/index.html"></iframe>');
        }
    }); 
});
</script>




<br/>


<br/>


<h3>IOS Application</h3>

<div style="display: flex;justify-content: center;align-items: center;">
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Weekend project. Will be open sourced soonish !! <a href="https://twitter.com/hashtag/Sentimentanalysis?src=hash&amp;ref_src=twsrc%5Etfw">#Sentimentanalysis</a> <a href="https://twitter.com/hashtag/DeepLearning?src=hash&amp;ref_src=twsrc%5Etfw">#DeepLearning</a> <a href="https://twitter.com/hashtag/ReactNative?src=hash&amp;ref_src=twsrc%5Etfw">#ReactNative</a> <a href="https://twitter.com/hashtag/MachineLearning?src=hash&amp;ref_src=twsrc%5Etfw">#MachineLearning</a> <a href="https://twitter.com/hashtag/NLP?src=hash&amp;ref_src=twsrc%5Etfw">#NLP</a> <a href="https://t.co/EyECl7waNF">pic.twitter.com/EyECl7waNF</a></p>&mdash; Danial (@DaniaL_KH) <a href="https://twitter.com/DaniaL_KH/status/975196959450447872?ref_src=twsrc%5Etfw">March 18, 2018</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>


<p> <a href="https://github.com/DanialK/livesentiment"><strong>Source Code</strong></a></p>

<!-- more -->




<br/>


<p>Creating machine learning models are often very fun for us AI/ML/DL enthusiasts and thanks to Python&#8217;s great community and great libraries such as TensroFlow and Keras this process has become very easy. With the help of Keras we can put layers together like pieces of a puzzle and focus on our architecture and performance and make things work within our beloved Jupyter Notebooks.</p>

<p>In practice, we often are building these models to help our users/clients and often we need to be able to ship these models somewhere and integrate them with our applications so our users can benefit from our models.</p>

<p>A usual approach is to create an API over the model so our backend can communicate with it and send the results back to the client. However, there are a few issues with this approach:</p>

<ul>
<li><p>First issue is the latency. Our app probably wouldn&#8217;t be as responsive as we want it to be if we have to make calls to our back-end and wait for the result to come back.</p></li>
<li><p>The second issue is the legal implications of sending user&#8217;s text or image over the network. Imagine if you have a translator app that takes an image of a document and translates the document for you. If your user is going to translate a confidential legal document with this app, it complicates the legal implications of your applications and the type of security you need to build around it.</p></li>
<li><p>Lastly, with this approach our users cannot benefit from our app when they are offline.</p></li>
</ul>


<br/>




<blockquote>
What if we could bundle our models with our app so all the model scoring could happen our their machine and they don&#8217;t need to be online?
<br/>
Well, that is exactly the solution.
</blockquote>


<p>We often make our models very deep to squeeze out as much accuracy as we can. But in reality a model that is 88% accurate and runs fast on an average mobile device and is very small in size is much better than a deep model that is offering 90% accurate but it&#8217;s not responsive on slow devices and increases our bundle size by big amount.</p>

<p>By tweaking our architecture and letting go of a few accuracy points, we often can create smaller versions of our models that are shippable in a mobile app or can be served over the web and can bring a lot of value to our users.</p>

<h3>Few rules of thumb on the architecture of models:</h3>

<ul>
<li><p>Start small and go big/deep</p></li>
<li><p>Use Convolutions instead of LSTMs or GRUs wherever you can. LSTMs and GRUs are great and often times they are our only solution when not just remembering the past, but also the order of the information matters to our problem. However, there are many cases that Convolutions can offer the same accuracy if not better than LSTMs when our problem is translational invariant such as sentiment analysis or most of the computer vision problems.</p></li>
<li><p>Remember in practice, 85% accuracy is often better than not having the feature in our application at all so don&#8217;t bother too much and improve incrementally</p></li>
</ul>


<h3>Source Code</h3>

<p>To demonstrate the idea, I created a sentiment analysis application that runs:</p>

<ul>
<li>on browser using TensorFlowJS in React application</li>
<li>on IOS using CoreML in a React Native Application</li>
<li>I didn&#8217;t bother with the Android after getting IOS and Web working, but if anyone sends a PR I&#8217;d be glad to merge</li>
</ul>


<p>You can find all the codes for model training, web and mobile application <a href="https://github.com/DanialK/livesentiment"><strong>HERE ON GITHUB</strong></a></p>

<h3>Resources:</h3>

<ul>
<li><a href="https://keras.io/">Keras</a></li>
<li><a href="https://js.tensorflow.org/">TensorFlow.JS</a></li>
<li><a href="https://Reactjs.org">React</a></li>
<li><a href="https://facebook.github.io/react-native/">React Native</a></li>
<li><a href="https://attardi.org/pytorch-and-coreml">How I Shipped a Neural Network on iOS with CoreML, PyTorch, and React Native</a></li>
<li><a href="https://willowtreeapps.com/ideas/integrating-trained-models-into-your-ios-app-using-core-ml">Integrating trained models into your iOS app using Core ML</a></li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Danial Khosravi</span></span>

      








  


<time datetime="2018-06-23T23:16:00+10:00" pubdate data-updated="true">Jun 23<span>rd</span>, 2018</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/convolutional-neural-networks/'>Convolutional Neural Networks</a>, <a class='category' href='/blog/categories/deep-learning/'>Deep Learning</a>, <a class='category' href='/blog/categories/ios/'>IOS</a>, <a class='category' href='/blog/categories/natural-language-processing/'>Natural Language Processing</a>, <a class='category' href='/blog/categories/react/'>React</a>, <a class='category' href='/blog/categories/react-native/'>React Native</a>, <a class='category' href='/blog/categories/sentiment-analysis/'>Sentiment Analysis</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://DanialK.github.com/blog/2018/06/23/shipping-deep-learning-models-in-web-and-mobile-applications/" data-via="DaniaL_KH" data-counturl="http://DanialK.github.com/blog/2018/06/23/shipping-deep-learning-models-in-web-and-mobile-applications/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2017/09/29/range-of-convolutional-neural-networks-on-fashion-mnist-dataset/" title="Previous Post: Range of Convolutional Neural Networks on Fashion-MNIST dataset">&laquo; Range of Convolutional Neural Networks on Fashion-MNIST dataset</a>
      
      
        <a class="basic-alignment right" href="/blog/2019/10/29/functional-programming-in-csharp/" title="Next Post: Functional Programming in C#">Functional Programming in C# &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2019/10/29/functional-programming-in-csharp/">Functional Programming in C#</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/06/23/shipping-deep-learning-models-in-web-and-mobile-applications/">Shipping Deep Learning Models in Web and Mobile Applications</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/09/29/range-of-convolutional-neural-networks-on-fashion-mnist-dataset/">Range of Convolutional Neural Networks on Fashion-MNIST dataset</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/09/27/deep-learning-pc-build/">Deep Learning PC Build</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/28/estimating-pi-using-monte-carlo-simulations/">Estimating Pi Using Monte Carlo Simulations</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/DanialK">@DanialK</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'DanialK',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("DaniaL_KH", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/DaniaL_KH" class="twitter-follow-button" data-show-count="false">Follow @DaniaL_KH</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2019 - Danial Khosravi -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'danialk';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://DanialK.github.com/blog/2018/06/23/shipping-deep-learning-models-in-web-and-mobile-applications/';
        var disqus_url = 'http://DanialK.github.com/blog/2018/06/23/shipping-deep-learning-models-in-web-and-mobile-applications/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
